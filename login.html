<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تسجيل الدخول - لكل الطلاب</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">

    <div class="bg-white p-8 md:p-12 rounded-2xl shadow-2xl max-w-md w-full text-center">
        <h1 class="text-3xl font-bold text-blue-900 mb-4">أهلاً بك في لكل الطلاب</h1>
        <p class="text-gray-600 mb-8">خطوة واحدة تفصلك عن الدراسة بذكاء.</p>

        <button id="google-login-btn" class="w-full bg-white border border-gray-300 text-gray-700 font-semibold py-3 px-4 rounded-lg flex items-center justify-center hover:bg-gray-100 transition duration-300">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google icon" class="w-6 h-6 ml-4"/>
            تسجيل الدخول باستخدام جوجل
        </button>

        <p id="error-message" class="text-red-500 mt-4 hidden"></p>
        <p id="loading-message" class="text-gray-500 mt-4 hidden">جاري التحميل...</p>

        <div class="mt-8 text-sm text-gray-500">
            <p>بالتسجيل، أنت توافق على شروط الخدمة وسياسة الخصوصية.</p>
        </div>
    </div>
    
    <script type="module">
        // --- START: Firebase Configuration ---
        // This is your project's unique configuration.
        const firebaseConfig = {
          apiKey: "AIzaSyCR520U7i2UNpfI7j7j6UsQgwby90_soNo",
          authDomain: "hussein-c5a1e.firebaseapp.com",
          projectId: "hussein-c5a1e",
          storageBucket: "hussein-c5a1e.appspot.com",
          messagingSenderId: "586967501445",
          appId: "1:586967501445:web:eb29cc2f2a75c3c542f7ec",
          measurementId: "G-STCGBPH282"
        };
        // --- END: Firebase Configuration ---

        // Import Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        const googleLoginBtn = document.getElementById('google-login-btn');
        const errorMessage = document.getElementById('error-message');
        const loadingMessage = document.getElementById('loading-message');

        // Redirect user if already logged in
        onAuthStateChanged(auth, (user) => {
            if (user) {
                window.location.href = 'dashboard.html';
            }
        });

        googleLoginBtn.addEventListener('click', () => {
            loadingMessage.classList.remove('hidden');
            errorMessage.classList.add('hidden');
            googleLoginBtn.disabled = true;

            signInWithPopup(auth, provider)
                .then((result) => {
                    const user = result.user;
                    console.log("Signed in successfully:", user);
                    window.location.href = 'dashboard.html';
                }).catch((error) => {
                    console.error("Login Error:", error.code, error.message);
                    errorMessage.textContent = 'حدث خطأ أثناء تسجيل الدخول. يرجى المحاولة مرة أخرى.';
                    errorMessage.classList.remove('hidden');
                }).finally(() => {
                    loadingMessage.classList.add('hidden');
                    googleLoginBtn.disabled = false;
                });
        });
    </script>
</body>
</html>

